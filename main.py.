import streamlit as st
import pandas as pd
import plotly.graph_objects as go
from datetime import datetime

# --- 1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙØ­Ø© ---
st.set_page_config(page_title="VesselCore Technical", page_icon="ğŸš¢", layout="wide")

# --- 2. Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø·ÙˆÙ„ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© ---
# Ù‡Ø°Ù‡ Ù‡ÙŠ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ØªÙŠ Ø³ØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¢Ù†
FLEET_DATABASE = {
    "NJ MOON": {"engine": "MAN B&W 6S50MC-C", "status": "Active"},
    "NJ MARS": {"engine": "MAN B&W 6S60MC-C", "status": "Active"},
    "NJ AIO": {"engine": "Mitsubishi UEC", "status": "Active"},
    "YARA J": {"engine": "MAN B&W 5S50MC-C", "status": "Active"},
}

# --- 3. Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© ---
with st.sidebar:
    st.title("ğŸš¢ VesselCore")
    st.subheader("Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙƒØªØ¨ Ø§Ù„ÙÙ†ÙŠ")
    st.write("**Ø§Ù„Ù…Ø¯ÙŠØ±:** Ù…Ø±ÙˆØ§Ù† ÙƒØ±ÙˆÙ…")
    st.divider()
    
    # Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø³ÙÙŠÙ†Ø© Ù…Ù† Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
    selected_ship = st.selectbox(
        "Ø§Ø®ØªØ± Ø§Ù„Ø³ÙÙŠÙ†Ø© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©:",
        options=list(FLEET_DATABASE.keys()),
        key="final_vessel_selector"
    )
    st.info(f"Ø§Ù„Ù…Ø­Ø±Ùƒ: {FLEET_DATABASE[selected_ship]['engine']}")

# --- 4. Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ---
st.title(f"Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙÙ†ÙŠØ©: {selected_ship}")

# Ø¹Ø±Ø¶ Ø£Ø±Ù‚Ø§Ù… Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (KPIs)
m1, m2, m3 = st.columns(3)
with m1:
    st.metric("Ø­Ù…Ù„ Ø§Ù„Ù…Ø­Ø±Ùƒ (Load %)", "85%", "2%")
with m2:
    st.metric("Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø§Ù„ÙˆÙ‚ÙˆØ¯ (SFOC)", "165 g/kWh", "-1.5%")
with m3:
    st.metric("Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ø¯Ù…", "385Â°C", "Stable")

st.divider()

# --- 5. Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù€ SFOC ---
st.subheader("ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ Ø§Ù„ÙˆÙ‚ÙˆØ¯ (SFOC Analysis)")
fig = go.Figure()
loads = [25, 50, 75, 85, 100]
sfoc_vals = [175, 170, 168, 165, 169]
fig.add_trace(go.Scatter(x=loads, y=sfoc_vals, mode='lines+markers', name='Actual', line=dict(color='#FF4B4B')))
fig.update_layout(xaxis_title="Engine Load (%)", yaxis_title="SFOC (g/kWh)")
st.plotly_chart(fig, use_container_width=True)

st.success(f"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª {selected_ship} Ø¨Ù†Ø¬Ø§Ø­.")
